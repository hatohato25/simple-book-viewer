# 電子書籍ビューア

ブラウザで利用できるシンプルな電子書籍ビューアー。画像ファイル、PDF、EPUB、ZIPファイルを見開き表示できます。

## [DEMO](https://hatohato25.github.io/simple-book-viewer/)
<img width="2212" height="1294" alt="スクリーンショット 2025-11-03 14 03 54" src="https://github.com/user-attachments/assets/0236596f-0941-4e31-92bc-9d8ca5578710" style="width: 40%;" />
<img width="2207" height="1294" alt="スクリーンショット 2025-11-03 14 04 20" src="https://github.com/user-attachments/assets/64fd2ec2-3745-4bd0-9eb9-82b841228526" style="width: 40%;" />
<img width="1932" height="1295" alt="スクリーンショット 2025-11-03 14 06 43" src="https://github.com/user-attachments/assets/6d91ef96-5957-4ee0-9e27-2e06cc4f61f6" style="width: 40%;" />
<img width="1840" height="1282" alt="スクリーンショット 2025-11-03 14 07 10" src="https://github.com/user-attachments/assets/6ea55e84-49e1-48ca-99ae-ccbc19be588d" style="width: 40%;" />

## 機能

### 📖 表示機能
- **見開き表示**: 2ページを並べて表示
  - 画像ファイル: 右→左の読み順（漫画形式）
  - PDFファイル: 左→右の読み順（書籍形式）
- **見開き調整**: ページのズレを調整するボタン
- **最大化表示**: フルスクリーンモードで没入感のある読書体験
- **サムネイル表示**: 全ページをグリッド表示し、目的のページへ素早くジャンプ

### 🎮 操作機能
- **ページ操作**: クリック領域、シークバー、キーボード、マウスホイールでページ送り/戻り
- **タッチジェスチャー**: スワイプでページ送り、ピンチズームで拡大縮小（モバイル対応）
- **ブックマーク**: 現在のページ位置を保存し、次回開いた時に続きから読める
- **最近読んだファイル**: 履歴から素早く再アクセス（最大10件、自動保存）

### 📁 対応形式
- **画像**: JPG, JPEG, PNG, GIF, WebP, AVIF
- **ドキュメント**: PDF, EPUB
- **アーカイブ**: ZIP、RAR（画像ファイルを含むアーカイブを自動展開）

### ⚡ その他
- **自然順ソート**: ファイル名の数字を正しく認識してソート（page1, page2, page10...）
- **レスポンシブ**: PC・タブレット・スマートフォン対応
- **フォルダドロップ対応**: フォルダをそのままドロップ可能
- **ローディング表示**: ファイル読み込み中のアニメーション表示
- **ファイル履歴**: IndexedDBでファイル全体を保存、ファイル移動後も再読込可能

## 使い方

### 1. GitHub Pagesで利用（推奨）

このリポジトリをforkして、自分専用のビューアを無料で公開できます。

1. このリポジトリを[fork](https://github.com/hatohato25/simple-book-viewer/fork)します
2. forkしたリポジトリの「Settings」→「Pages」を開きます
3. 「Source」で「Deploy from a branch」を選択
4. 「Branch」で「main」ブランチと「/(root)」を選択し「Save」をクリック
5. 数分待つと、`https://<あなたのユーザー名>.github.io/simple-book-viewer/`でアクセスできます

**メリット**:
- インストール不要でブラウザから直接利用可能
- スマートフォンやタブレットからもアクセス可能
- 自分専用のURLで、いつでもどこでも読書できる
- ファイル履歴機能により、端末内にデータを保存して続きから読める

**注意**: GitHub Pagesは静的サイトホスティングサービスです。アップロードしたファイルはあなたのブラウザのIndexedDBに保存され、他の端末と同期されません。

### 2. ローカルサーバーを起動

```bash
npm install
npm start
```

ブラウザが自動的に開きます（http://localhost:8080）

**重要**: ファイル直接開き（file://）では動作しません。必ずローカルサーバー経由でアクセスしてください。

### 3. ファイルを読み込む

#### 最近読んだファイルから開く
1. ブラウザを開くと、最近読んだファイルの履歴が表示されます
2. 履歴カードをクリックすると、前回の続きから読書を再開できます
3. 「×」ボタンで個別削除、「全クリア」ボタンで全履歴を削除できます

#### ドロップゾーンをクリックして開く
1. ドロップゾーンをクリックすると**ファイル選択モーダル**が表示されます
2. モーダルから選択できる読み込み方法：
   - **「ファイルを選択」**: PDF、EPUB、ZIP、画像ファイル（複数選択可）
   - **「フォルダを選択」**: 画像が入ったフォルダを直接選択
3. 選択後、自動的にファイルが読み込まれます

#### ドラッグ&ドロップで開く
以下の方法でも読み込めます：

**画像ファイルの場合**
1. Finderまたはエクスプローラーで画像フォルダを開く
2. **フォルダをそのままドロップ**、または
3. **Ctrl+A**（Windows）または**Cmd+A**（Mac）でフォルダ内の全ファイルを選択してドロップ

**PDFファイルの場合**
1. PDFファイルをブラウザのドロップゾーンにドラッグ&ドロップ

**ZIPファイルの場合**
1. 画像ファイルを含むZIPファイルをブラウザのドロップゾーンにドラッグ&ドロップ
2. ZIPファイルが自動的に展開され、画像が表示されます

**RARファイルの場合**
1. 画像ファイルを含むRARファイルをブラウザのドロップゾーンにドラッグ&ドロップ
2. RARファイルが自動的に展開され、画像が表示されます

**EPUBファイルの場合**
1. EPUBファイルをブラウザのドロップゾーンにドラッグ&ドロップ
2. EPUB内の画像が自動的に抽出され、表示されます

### 4. ページ操作

- **クリック領域**: 画面左右をクリックしてページ移動
- **キーボード**:
  - 画像/EPUB: **←キー**（次）/ **→キー**（前）
  - PDF: **→キー**（次）/ **←キー**（前）
- **マウスホイール**: 下に回すと次ページ、上に回すと前ページ
- **タッチジェスチャー**（スマートフォン・タブレット）:
  - **スワイプ**: 左右にスワイプしてページ移動
  - **ピンチズーム**: 2本指でピンチ操作して拡大縮小（1倍〜3倍）
- **シークバー**: 下部のシークバーで任意のページにジャンプ
- **見開き調整**: 下部の「見開き調整」ボタンでページのズレを修正
- **最大化表示**: 下部の「⛶」ボタンでフルスクリーン表示
- **ブックマーク**: 下部のリボンアイコンで現在のページを保存
- **サムネイル**: 下部のグリッドアイコンで全ページ一覧を表示
- **リセット**: 上部の「閉じる」ボタンで別のファイルを読み込む

## ブラウザ対応

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## トラブルシューティング

### 画像が表示されない

- **原因**: file://プロトコルで開いている
- **解決**: `npm start`でローカルサーバーを起動してください

### PDFが表示されない

- **原因**: ネットワーク接続がない（PDF.jsがCDNから読み込めない）
- **解決**: インターネット接続を確認してください

### ページが正しく並ばない

- **原因**: ファイル名のソート順が不適切
- **解決**: ファイル名を`page001.jpg`, `page002.jpg`のように統一してください

### 見開きがズレている

- **原因**: 表紙などで奇数ページから始まっている
- **解決**: 下部の「見開き調整」ボタンをクリックしてズレを修正してください

### ZIPファイルが展開されない

- **原因**: ネットワーク接続がない（JSZipがCDNから読み込めない）
- **解決**: インターネット接続を確認してください

### ZIP/RARファイル内に画像が表示されない

- **原因**: アーカイブ内に画像ファイルが含まれていない
- **解決**: JPG, PNG, GIF, WebP, AVIFのいずれかの形式の画像ファイルを含むアーカイブを使用してください

## Vercelへのデプロイ（RAR対応版）

RAR形式のファイル展開を有効にするには、SharedArrayBufferをサポートするホスティング環境が必要です。
GitHub PagesではCOOP/COEPヘッダーを設定できないため、Vercelを使用します。

### 前提条件

- GitHubアカウント
- Vercelアカウント（無料）

### デプロイ手順

1. **Vercelにログイン**
   - https://vercel.com/ にアクセス
   - GitHubアカウントで連携

2. **新しいプロジェクトを作成**
   - "Add New..." → "Project" をクリック
   - GitHubリポジトリを選択（例: `hatohato25/simple-book-viewer`）

3. **デプロイ設定**
   - Framework Preset: "Other"（静的サイト）
   - Root Directory: `./`（デフォルト）
   - Build Command: 空欄（ビルド不要）
   - Output Directory: `./`（デフォルト）
   - "Deploy" をクリック

4. **デプロイ完了**
   - 数分でデプロイ完了
   - 提供されたURLにアクセス（例: `https://your-project.vercel.app`）

### COOP/COEPヘッダーの確認

`vercel.json` ファイルに以下のヘッダー設定が含まれています：

```json
{
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "Cross-Origin-Opener-Policy",
          "value": "same-origin"
        },
        {
          "key": "Cross-Origin-Embedder-Policy",
          "value": "require-corp"
        },
        {
          "key": "Cross-Origin-Resource-Policy",
          "value": "cross-origin"
        }
      ]
    }
  ]
}
```

これにより、SharedArrayBufferが有効化され、RAR形式の展開が可能になります。

### 注意事項

- **GitHub Pagesとの併用**: GitHub Pagesでは引き続きRAR形式は動作しません（ZIP/EPUB/PDF/画像は動作）
- **カスタムドメイン**: Vercelのプロジェクト設定からカスタムドメインを設定可能
- **自動デプロイ**: GitHubリポジトリへのpush時に自動的に再デプロイされます

## ライセンス

MIT License
